# JokemGym Template System ğŸ‹ï¸â€â™‚ï¸

Este repositorio es un **TEMPLATE WHITE-LABEL** diseÃ±ado para crear instancias independientes de aplicaciones de gestiÃ³n para gimnasios.

> **âš ï¸ IMPORTANTE:** Este cÃ³digo es una BASE. No debe correrse en producciÃ³n tal cual. Cada gimnasio requiere su propio repositorio clonado y su propia configuraciÃ³n.

---

## ğŸ—ï¸ Arquitectura del Sistema

El sistema utiliza un enfoque de **"ConfiguraciÃ³n como CÃ³digo"** para garantizar que cada gimnasio sea Ãºnico pero mantenible desde una base comÃºn.

### Componentes Clave

1.  **`tenant.setup.json` (Input):** Archivo JSON (privado por gym) que define TODO: nombre, colores, moneda, timezone, planes activos y precios.
2.  **`npm run tenant:build` (Motor):** Script que toma el JSON y genera:
    *   **Frontend Config:** `src/config/app.config.ts` (TypeScript estÃ¡tico).
    *   **Database Config:** `supabase/seed/seed.<id>.sql` (Datos SQL).
3.  **Guardrails:** La aplicaciÃ³n UI se bloquea si intentas correrla sin haber ejecutado el proceso de configuraciÃ³n, evitando que uses una versiÃ³n "genÃ©rica" por error.

---

## ğŸš€ GuÃ­a de Inicio RÃ¡pido (Crear nuevo Gym)

Sigue estos pasos para desplegar un nuevo cliente desde este template.

### 1. PreparaciÃ³n del Entorno
Clona este repositorio y entra en la carpeta `ui`:
```bash
git clone <url-repo-template> nuevo-gym
cd nuevo-gym/ui
npm install
```

### 2. ConfiguraciÃ³n del Tenant
1.  Duplica el archivo de ejemplo:
    ```bash
    cp tenant.setup.json.example tenant.setup.json
    ```
2.  Edita `tenant.setup.json` con los datos reales del cliente:
    *   **Branding:** Nombre, tagline, logo (ruta en `/public`).
    *   **Producto:** Moneda (USD, CRC, etc.), Timezone (America/Panama), Unidades.
    *   **Planes:** Habilita (`enabled: true`) solo los planes que el gym vende y define sus precios.

### 3. Generar Artefactos
Ejecuta el script de construcciÃ³n del tenant. Esto transformarÃ¡ tu JSON en cÃ³digo y SQL.
```bash
npm run tenant:build
```
*Si todo sale bien, verÃ¡s `âœ… TENANT BUILD COMPLETE`.*

### 4. Configurar Base de Datos (Supabase)
1.  Crea un nuevo proyecto en Supabase para este cliente.
2.  Copia `.env.example` a `.env` y coloca las credenciales (`NEXT_PUBLIC_SUPABASE_URL`, `ANON_KEY`, etc.).
3.  Ve al **SQL Editor** de Supabase y ejecuta:
    1.  **MigraciÃ³n Core:** `supabase/migrations/001_core.sql` (Crea las tablas).
    2.  **Seed Generado:** `supabase/seed/seed.<tu-gym-id>.sql` (Inserta la configuraciÃ³n y planes).

### 5. Ejecutar
```bash
npm run dev
```
La aplicaciÃ³n deberÃ­a iniciar con el branding, moneda y planes configurados.

---

## ğŸ› ï¸ Comandos Disponibles

| Comando | DescripciÃ³n |
| :--- | :--- |
| `npm run dev` | Inicia el servidor de desarrollo (UI). |
| `npm run tenant:build` | Genera/Actualiza la configuraciÃ³n basada en `tenant.setup.json`. |
| `npm run build` | Compila la aplicaciÃ³n Next.js para producciÃ³n. |

---

## ğŸ“‚ Estructura de Archivos Relevante

```text
ui/
â”œâ”€â”€ tenant.setup.json.example   # Plantilla de configuraciÃ³n (copiar a .json)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ tenant-build.ts         # Orquestador del build
â”‚   â”œâ”€â”€ generate-app-config.ts  # Generador de TypeScript para UI
â”‚   â””â”€â”€ generate-seed-sql.ts    # Generador de SQL para DB
â”œâ”€â”€ src/
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ app.config.ts       # (GENERADO) Config final usada por la UI
â”‚       â””â”€â”€ plans.catalog.ts    # CatÃ¡logo universal de todos los planes posibles
â””â”€â”€ supabase/
    â”œâ”€â”€ migrations/             # Schema base de la DB
    â””â”€â”€ seed/                   # (GENERADO) Scripts de datos iniciales
```

## ğŸ” Seguridad y Notas TÃ©cnicas

*   **Sin DB Local:** Este template no usa Docker ni BD local. Todo conecta a Supabase.
*   **Timezones:** El sistema respeta el timezone configurado en `product.config` para el cÃ¡lculo de vencimientos, independiente de dÃ³nde estÃ© el usuario.
*   **Aislamiento:** `tenant.setup.json` y los seeds generados estÃ¡n en `.gitignore` para evitar subir datos sensibles o especÃ­ficos de un cliente al repo base por error.
